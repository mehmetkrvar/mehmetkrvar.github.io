<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aşk Kıvılcımları - Evrensel</title>
    <style>
        :root {
            /* Temel Renkler */
            --bg-color: #02000f;
            --dust-color-1: #ffffff;
            --dust-color-2: #fff0c1;
            --star-glow-base: rgba(255, 235, 190, 0.7);
            --star-core-base: #fff8e1;
            --text-color: #e8eaf6;
            --instruction-color: rgba(200, 220, 255, 0.6);
            --ripple-color: rgba(255, 255, 255, 0.5);
            --bg-star-color: rgba(255, 255, 255, 0.7);

            /* Duyarlı Font Boyutları */
            --base-font-size: clamp(10px, 1.8vw, 16px);
            --message-font-size: clamp(1.1em, 2.8vw, 1.5em); /* Mesajlar biraz daha büyük */

             /* Atmosfer Değişimi İçin */
            --bg-overlay-opacity: 0; /* Başlangıçta görünmez */
            --bg-overlay-color: radial-gradient(ellipse at center, rgba(40, 10, 60, 0.3) 0%, transparent 70%);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html, body {
            height: 100%;
            overflow: hidden;
            background-color: var(--bg-color);
            font-family: 'Georgia', 'Times New Roman', Times, serif;
            font-size: var(--base-font-size);
        }

        #space-canvas {
            position: relative;
            width: 100%;
            height: 100%;
            cursor: crosshair;
            background-image: radial-gradient(circle, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 60px 60px;
            background-position: 0 0;
            animation: moveBackground 240s linear infinite; /* Daha da yavaş */
            z-index: 1;
        }
        /* Atmosfer değişim katmanı */
        #space-canvas::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: var(--bg-overlay-color);
            opacity: var(--bg-overlay-opacity);
            transition: opacity 5s ease-in-out; /* Yumuşak geçiş */
            pointer-events: none;
            z-index: 2; /* Arka plan yıldızlarının önünde, ana içeriğin arkasında */
        }


        @keyframes moveBackground {
            from { background-position: 0 0; }
            to { background-position: 1200px 1200px; }
        }

        /* Arka Plan Kayan Yıldız Konteyneri */
        #bg-shooting-stars {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none;
            overflow: hidden; /* Konteyner dışına taşmasınlar */
            z-index: 0; /* En arkada */
        }

        .bg-shooting-star {
            position: absolute;
            width: 1px; /* Çok ince */
            height: 50px; /* Kısa kuyruk */
            background: linear-gradient(to bottom, var(--bg-star-color) 0%, transparent 100%);
            filter: blur(0.5px); /* Hafif bulanık */
            /* Animasyon JS ile atanacak */
            opacity: 0; /* Başlangıçta gizli */
            transform-origin: top center;
        }

        #instructions {
            position: absolute; top: 30px; left: 50%;
            transform: translateX(-50%); color: var(--instruction-color);
            font-size: 0.9em; font-style: italic; pointer-events: none;
            opacity: 1; transition: opacity 1s ease-out 3s; z-index: 30;
        }

        .click-ripple {
            position: absolute; width: 20px; height: 20px;
            border: 2px solid var(--ripple-color); border-radius: 50%;
            transform: translate(-50%, -50%) scale(0); opacity: 1;
            pointer-events: none; animation: rippleEffect 0.6s ease-out forwards;
            z-index: 10;
        }
        @keyframes rippleEffect { /* Aynı kaldı */
            from { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            to { transform: translate(-50%, -50%) scale(3); opacity: 0; }
        }

        .stardust {
            position: absolute; width: 3px; height: 3px;
            background-color: var(--dust-color-1); border-radius: 50%;
            pointer-events: none; opacity: 0; z-index: 20;
        }

        .formed-star {
            position: absolute; border-radius: 50%; pointer-events: none;
            transform: translate(-50%, -50%) scale(0); opacity: 0;
            animation: appearStar 1s ease-out forwards 0.5s; z-index: 5;
        }
        @keyframes appearStar { /* Aynı kaldı */
             0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 0; }
            70% { transform: translate(-50%, -50%) scale(1.2) rotate(180deg); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1) rotate(360deg); opacity: 1; }
        }

        #message-display {
            position: absolute;
            bottom: 5%; /* Biraz yukarı */
            left: 5%; right: 5%;
            text-align: center;
            z-index: 30;
            pointer-events: none;
            height: 5em; /* Yaklaşık 2 satır mesaja yer aç, sabit yükseklik */
            display: flex;
            justify-content: center;
            align-items: center; /* Mesajı dikeyde ve yatayda ortala */
        }

        .romantic-phrase {
            position: absolute; /* Sadece bir mesaj görüneceği için absolute olabilir */
            color: var(--text-color);
            font-size: var(--message-font-size);
            text-shadow: 0 0 7px rgba(180, 200, 255, 0.8);
            padding: 8px 15px;
            background: linear-gradient(rgba(15, 25, 50, 0.2), rgba(15, 25, 50, 0.6), rgba(15, 25, 50, 0.2));
            border-radius: 10px;
            max-width: 90%;
            word-wrap: break-word;
            opacity: 0; /* Başlangıçta gizli */
            transform: translateY(10px) scale(0.95); /* Hafif başlangıç durumu */
            /* Animasyonlar JS tarafından kontrol edilecek veya class ile */
        }

        /* Mesaj Giriş/Çıkış Animasyonları */
        .phrase-fade-in {
            animation: fadeInPhrase 1.2s cubic-bezier(0.25, 1, 0.5, 1) forwards;
        }
        .phrase-fade-out {
             animation: fadeOutPhrase 0.2s cubic-bezier(0.5, 0, 0.75, 0) forwards;
        }

        @keyframes fadeInPhrase {
             from { opacity: 0; transform: translateY(10px) scale(0.95); }
             to { opacity: 1; transform: translateY(0) scale(1); }
        }
        @keyframes fadeOutPhrase {
             from { opacity: 1; transform: translateY(0) scale(1); }
             to { opacity: 0; transform: translateY(-10px) scale(0.95); }
        }

         /* Sonsuzluk mesajı için özel stil */
        .final-phrase {
             font-size: clamp(1.3em, 3.2vw, 1.8em); /* Biraz daha büyük */
             font-weight: bold;
             text-shadow: 0 0 12px rgba(255, 220, 180, 0.9); /* Daha sıcak parlama */
        }

    </style>
</head>
<body>

    <div id="bg-shooting-stars">
        </div>

    <div id="space-canvas">
        <div id="instructions">Evreni aşkla doldurmak için dokun veya tıkla...</div>
        </div>

    <div id="message-display">
        </div>

    <script>
        // Element Referansları
        const spaceCanvas = document.getElementById('space-canvas');
        const instructions = document.getElementById('instructions');
        const messageDisplay = document.getElementById('message-display');
        const bgStarsContainer = document.getElementById('bg-shooting-stars');

        // Durum Değişkenleri
        let starCount = 0;
        let instructionVisible = true;
        let numParticles = window.innerWidth < 768 ? 15 : 25;
        let currentMessageElement = null; // Şu an ekranda olan mesaj
        const atmosphereChangeThreshold = 7; // Kaç yıldızdan sonra atmosfer değişsin
        const numBgShootingStars = 10; // Arka planda aynı anda kaç kayan yıldız olsun

        // Romantik Mesajlar (Aynı kaldı, isteğe bağlı değiştirilebilir)
        const romanticPhrases = [
            "Bir dokunuş... ve bir evren uyandı.", "Karanlıkta parlayan ilk ışık sensin.", "Yalnız atomlar dansa durdu.",
            "Yörüngelerimiz kesiştiğinde zaman durdu.", "İki ruh... şimdi tek bir takımada.", "Seninle her an, yeni bir galaksi keşfi.",
            "Aramızdaki çekim, tüm karadeliklerden güçlü.", "Bu bizim sonsuzluğumuzun başlangıcı.", "Yarattığımız ışık, evrene yolu gösteriyor.",
            "Ve aşkımız, kozmosun en güzel şarkısı oldu.", "Yıldızlar şahidimiz olsun bu sevdaya...",
            "Kalplerimiz aynı ritimde atıyor, nebula gibi.", "Seninle kaybolmak, asıl kendimi bulmak demek.",
            "Gözlerindeki ışıltı, en parlak süpernova.", "Birlikte yazdığımız bu destan hiç bitmesin."
        ];

        // --- Yardımcı Fonksiyonlar ---
        function random(min, max) { return Math.random() * (max - min) + min; }
        function randomInt(min, max) { return Math.floor(random(min, max + 1)); }

        // --- Olay Yönetimi ---
        function handleInteraction(event) {
            event.preventDefault();
            let clientX, clientY;
            if (event.touches) {
                clientX = event.touches[0].clientX; clientY = event.touches[0].clientY;
            } else {
                clientX = event.clientX; clientY = event.clientY;
            }

            if (instructionVisible) {
                instructions.style.opacity = '0'; instructionVisible = false;
            }

            createClickRipple(clientX, clientY);
            createStardustEffect(clientX, clientY);
            setTimeout(() => createPermanentStar(clientX, clientY), 150);
            triggerRomanticMessage(); // Mesajı tetikle
            starCount++;

             // Atmosfer Değişimi Kontrolü
             if (starCount === atmosphereChangeThreshold) {
                 document.documentElement.style.setProperty('--bg-overlay-opacity', '1');
                 document.documentElement.style.setProperty('--bg-overlay-color', 'radial-gradient(ellipse at center, rgba(60, 20, 80, 0.4) 0%, transparent 75%)'); // Morumsu ton
             } else if (starCount === atmosphereChangeThreshold * 2) {
                 document.documentElement.style.setProperty('--bg-overlay-color', 'radial-gradient(ellipse at center, rgba(20, 60, 80, 0.5) 0%, transparent 70%)'); // Mavimsi ton
             }
        }
        spaceCanvas.addEventListener('click', handleInteraction);
        spaceCanvas.addEventListener('touchstart', handleInteraction, { passive: false });

        // --- Efekt Oluşturma Fonksiyonları ---
        function createClickRipple(x, y) { /* Öncekiyle aynı */
            const ripple = document.createElement('div');
            ripple.classList.add('click-ripple');
            ripple.style.left = `${x}px`; ripple.style.top = `${y}px`;
            spaceCanvas.appendChild(ripple);
            ripple.addEventListener('animationend', () => ripple.remove());
        }

        function createStardustEffect(x, y) { /* Öncekiyle aynı, sadece numParticles kullanıyor */
             const spreadRadius = window.innerWidth < 768 ? 40 : 60;
             const animationDuration = 800;
             for (let i = 0; i < numParticles; i++) {
                const dust = document.createElement('div');
                dust.classList.add('stardust');
                const angle = random(0, Math.PI * 2); const radius = random(spreadRadius * 0.2, spreadRadius);
                const startX = x + Math.cos(angle) * radius; const startY = y + Math.sin(angle) * radius;
                dust.style.left = `${startX}px`; dust.style.top = `${startY}px`;
                const particleSize = random(2, 4); dust.style.width = `${particleSize}px`; dust.style.height = `${particleSize}px`;
                const dustColor = Math.random() > 0.4 ? 'var(--dust-color-1)' : 'var(--dust-color-2)';
                dust.style.backgroundColor = dustColor; dust.style.boxShadow = `0 0 ${random(3, 6)}px ${random(1, 2)}px ${dustColor}`;
                spaceCanvas.appendChild(dust);
                const animation = dust.animate([
                    { transform: `translate(0, 0) scale(1)`, opacity: 1, offset: 0 },
                    { transform: `translate(${x - startX}px, ${y - startY}px) scale(0.7)`, opacity: 0.9, offset: 0.7 },
                    { transform: `translate(${x - startX}px, ${y - startY}px) scale(0.1)`, opacity: 0, offset: 1 }
                ], { duration: animationDuration + random(-150, 150), easing: 'cubic-bezier(0.7, 0, 0.8, 0.6)', fill: 'forwards' });
                animation.onfinish = () => dust.remove();
            }
        }

        function createPermanentStar(x, y) { /* Öncekiyle aynı, çeşitlilik içeriyor */
            const star = document.createElement('div');
            star.classList.add('formed-star');
            star.style.left = `${x}px`; star.style.top = `${y}px`;
            const coreSize = random(4, 8); star.style.width = `${coreSize}px`; star.style.height = `${coreSize}px`;
            const tempShift = random(-20, 20); star.style.filter = `hue-rotate(${tempShift}deg) brightness(${random(0.9, 1.3)})`;
            star.style.backgroundColor = `var(--star-core-base)`;
            const glowSize = coreSize * 2.5; const haloSize = coreSize * 5;
            star.style.boxShadow = `0 0 ${glowSize}px ${coreSize * 0.8}px var(--star-glow-base), 0 0 ${haloSize}px ${coreSize * 1.5}px rgba(255, 255, 255, 0.15)`;
            spaceCanvas.appendChild(star);
        }

        // --- Arka Plan Kayan Yıldızları Oluşturma ve Yönetme ---
        function createBackgroundShootingStar() {
            const star = document.createElement('div');
            star.classList.add('bg-shooting-star');

            // Rastgele başlangıç pozisyonu ve açı
            const startSide = randomInt(0, 3); // 0:top, 1:left, 2:right, 3:bottom (nadiren)
            let startXPercent, startYPercent, angle;
            const duration = random(3, 8); // Daha yavaşlar

            switch (startSide) {
                case 0: // Top
                    startXPercent = random(0, 100); startYPercent = -5; angle = random(120, 160); break;
                case 1: // Left
                    startXPercent = -5; startYPercent = random(0, 100); angle = random(30, 70); break;
                case 2: // Right
                    startXPercent = 105; startYPercent = random(0, 100); angle = random(210, 250); break;
                case 3: // Bottom (daha az olasılıkla)
                default:
                     if (Math.random() > 0.8) { // Sadece %20 ihtimalle alttan başlasın
                         startXPercent = random(0, 100); startYPercent = 105; angle = random(300, 340);
                     } else { // Çoğunlukla üstten
                         startXPercent = random(0, 100); startYPercent = -5; angle = random(120, 160);
                     }
                     break;
            }

            star.style.left = `${startXPercent}%`;
            star.style.top = `${startYPercent}%`;
            star.style.transform = `rotate(${angle}deg)`;

            bgStarsContainer.appendChild(star);

            // Animasyon (JS Web Animations API)
             const distance = Math.max(window.innerWidth, window.innerHeight) * 1.5; // Ekranın köşegeninden daha uzun mesafe
             const moveX = Math.cos((angle - 90) * Math.PI / 180) * distance;
             const moveY = Math.sin((angle - 90) * Math.PI / 180) * distance;

            const animation = star.animate([
                { transform: `rotate(${angle}deg) translate(0, 0) scaleY(0.5)`, opacity: 0 }, // Başlangıçta kısa ve gizli
                { transform: `rotate(${angle}deg) translate(${moveX * 0.05}px, ${moveY * 0.05}px) scaleY(1)`, opacity: 1, offset: 0.1 }, // Hızla belir ve uzamaya başla
                { transform: `rotate(${angle}deg) translate(${moveX}px, ${moveY}px) scaleY(1)`, opacity: 0, offset: 1 } // Uzaklaşırken kaybol
            ], {
                duration: duration * 1000,
                easing: 'linear',
                 delay: random(0, 5000) // Başlangıç gecikmesi
            });

            // Animasyon bitince elementi kaldır ve yenisini oluştur (sürekli akış için)
            animation.onfinish = () => {
                star.remove();
                 // Hemen yenisini oluşturmak yerine, belirli aralıklarla kontrol edip eksik varsa eklemek daha iyi olabilir
                 // Şimdilik basit tutalım: bitince yenisini rastgele zamanla tetikle
                 setTimeout(createBackgroundShootingStar, random(1000, 5000));
            };
        }

        // --- Mesaj Yönetimi (Sıralı Gösterim) ---
        function triggerRomanticMessage() {
            let phraseText = "";
            let isFinal = false;

            if (starCount < romanticPhrases.length) {
                phraseText = romanticPhrases[starCount];
            } else if (starCount === romanticPhrases.length) {
                phraseText = "Ve evrenimiz aşkla doldu... ∞";
                isFinal = true;
            } else {
                return; // Tüm mesajlar gösterildi, daha fazla gösterme
            }

            // Mevcut mesajı kaldır (varsa)
            if (currentMessageElement) {
                const oldMsg = currentMessageElement; // Referansı sakla
                oldMsg.classList.remove('phrase-fade-in');
                oldMsg.classList.add('phrase-fade-out');
                // Animasyon bitince DOM'dan kaldır
                oldMsg.addEventListener('animationend', () => {
                    // Hata kontrolü: Element hala DOM'daysa kaldır
                    if (oldMsg.parentNode === messageDisplay) {
                        messageDisplay.removeChild(oldMsg);
                    }
                }, { once: true }); // Olay dinleyiciyi bir kez çalıştır
            }

            // Yeni mesajı oluştur ve göster
            const newPhraseElement = document.createElement('p');
            newPhraseElement.classList.add('romantic-phrase');
            if (isFinal) {
                 newPhraseElement.classList.add('final-phrase');
            }
            newPhraseElement.textContent = phraseText;

            messageDisplay.appendChild(newPhraseElement);
            newPhraseElement.classList.add('phrase-fade-in'); // Fade-in animasyonunu başlat

            // Yeni mesajı mevcut olarak ayarla
            currentMessageElement = newPhraseElement;
        }


        // --- Başlatma Fonksiyonları ---
        function initCosmos() {
            // Arka plan kayan yıldızlarını başlat
            for (let i = 0; i < numBgShootingStars; i++) {
                 // Başlangıçta rastgele gecikmelerle oluştur
                 setTimeout(createBackgroundShootingStar, random(0, 3000));
            }

            // (Mobil için parçacık sayısı zaten global değişkende ayarlandı)
        }

        window.addEventListener('load', initCosmos);
        // Ekran yeniden boyutlandığında parçacık sayısını ayarla (opsiyonel, basit tutuldu)
        window.addEventListener('resize', () => {
             numParticles = window.innerWidth < 768 ? 15 : 25;
        });

    </script>

</body>
</html>
